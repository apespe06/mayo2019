create table KTIPOPACIENTE(
CLAVETIPOPACIENTE int not null primary key,
DESCRIPCION varchar(64) not null,
URGENCIAS int not null,
SITUACION int not null );

create table TRABAJADOR(
CONTROLTRABAJADOR int not null primary key,
CLAVESERVICIO int not null,	
CLAVEUNIDADMEDICA int not null,
CLAVETIPOTRABAJADOR int not null,
TRATO VARCHAR(28) NOT NULL,
PATERNO VARCHAR(28) NOT NULL,
MATERNO VARCHAR(28) NOT NULL,
NOMBRE VARCHAR(28) NOT NULL,
SEXO VARCHAR(2) NOT NULL,
CEDULAPROFESIONAL int, 
MATRICULA int not null,
TURNO varchar(2),
LOGIN varchar(9),
CLAVEMEDICO varchar(4)
);


INSERT INTO `hospital`.`trabajador` (
`CONTROLTRABAJADOR` ,
`CLAVESERVICIO` ,
`CLAVEUNIDADMEDICA` ,
`CLAVETIPOTRABAJADOR` ,
`TRATO` ,
`PATERNO` ,
`MATERNO` ,
`NOMBRE` ,
`SEXO` ,
`CEDULAPROFESIONAL` ,
`MATRICULA` ,
`TURNO` ,
`LOGIN` ,
`CLAVEMEDICO` 
)
VALUES (
'1', '2', '3', '4', 'hola', 'Alvarado', 'Pineda', 'Esperanza', 'f', NULL , '201114660', 'm', 'espe06', '1234'
);


create table KUNIDADMEDICA(
CLAVEUNIDADMEDICA int not null PRIMARY KEY,
DESCRIPCION varchar(128),
CLAVETIPOUNIDAD int,
NIVEL int,
CLAVEREGION int
);

create table KTIPOUNIDADMEDICA(
CLAVETIPOUNIDAD int not null primary key,
DESCRIPCION varchar(64),
CLAVESITUACION int(2)
);

create table KSERVICIO(
CLAVESERVICIO int not null primary key,
DESCRIPCION varchar(64),
CLAVESITUACION int(2),	
PERMITIDOPRESCRIBIRMEDICAMENTX int(2),	
EXPEDIRINCAPACIDAD int(2)
);

create table PACIENTE(
CONTROLPACIENTE int not null primary key,
PATERNO varchar(28),
MATERNO varchar(28),
NOMBRE varchar(28),
SEXO varchar(2),	
FECHANACIMIENTO date,
NOAFILIACION int,
AFILIACIONANTERIOR varchar(28),
CLAVESITUACION int(2),
CLAVETIPOPACIENTE int(4)
);

create table KCIE10(
CLAVEDIAGNOSTICO int not null primary key,
NIVEL1 int(2),
NIVEL2 int(2),
NIVEL3 int(2),
NIVEL4 int(2),
NIVEL5 int(2),
CODIGO varchar(8),
TITULO varchar(32),
ULTIMONIVEL varchar(2)
);

CREATE TABLE NMEDICA(
id_nmedica int not null auto_increment primary key,
FECHACONSULTA DATE NOT NULL,
CLAVEMEDICO VARCHAR(12) NOT NULL,
AFILIACIONP VARCHAR(64) NOT NULL,
ALTURA VARCHAR(6),
PESO VARCHAR(4),
MCORPORAL VARCHAR(6),
TEMPERATURA VARCHAR(6),
FRECUENCIAR VARCHAR(6),
PRESIONA VARCHAR(6),
FRECUENCIAC VARCHAR(6),
DIAGNOSTICO VARCHAR(32) NOT NULL,
DIAGNOSTICO2 VARCHAR(32),
DIAGNOSTICO3 VARCHAR(32),
NOTA VARCHAR(250) NOT NULL

);


select A.TRATO, A.NOMBRE, A.PATERNO, A.MATERNO, A.CLAVESERVICIO, A.CLAVEUNIDADMEDICA,
 B.DESCRIPCION, C.DESCRIPCION, C.CLAVETIPOUNIDAD, D.DESCRIPCION
from TRABAJADOR A, KSERVICIO B, KUNIDADMEDICA C, KTIPOUNIDADMEDICA D
where A.CLAVEMEDICO = 'T340'
AND B.CLAVESERVICIO = A.CLAVESERVICIO
AND C.CLAVEUNIDADMEDICA = A.CLAVEUNIDADMEDICA
AND D.CLAVETIPOUNIDAD = C.CLAVETIPOUNIDAD ;

SELECT A.AFILIACIONANTERIOR, A.NOMBRE, A.PATERNO, A.MATERNO, A.SEXO, A.FECHANACIMIENTO, A.CLAVETIPOPACIENTE, 
B.CLAVETIPOPACIENTE, B.DESCRIPCION
FROM PACIENTE A, KTIPOPACIENTE B
WHERE A.AFILIACIONANTERIOR = 'AACJ52092501'
AND B.CLAVETIPOPACIENTE = A.CLAVETIPOPACIENTE;

mysqli_query($link,"insert into NMEDICA(FECHACONSULTA,CLAVEMEDICO,AFILIACIONP,NOTA,DIAGNOSTICO,
	DIAGNOSTICOA,DIAGNOSTICOB,TIPOCONSULTA,FOLIOINCAPACIDAD,FECHAINICIO,DIASINCAPACIDAD) 
		values ($fecha','$cm', '$afiliacion', '$texto','$diagnostico', '$diagnosticoa',
			'$diagnosticob', '$tipoc', '$folioi', '$finicio', '$diasi')");

CREATE TABLE NMEDICA(
id_nmedica int not null auto_increment primary key,
FECHACONSULTA DATE NOT NULL,
CLAVEMEDICO VARCHAR(12) NOT NULL,
AFILIACIONP VARCHAR(64) NOT NULL,
ALTURA VARCHAR(6),
PESO VARCHAR(4),
MCORPORAL VARCHAR(6),
TEMPERATURA VARCHAR(6),
FRECUENCIAR VARCHAR(6),
PRESIONA VARCHAR(6),
FRECUENCIAC VARCHAR(6),
DIAGNOSTICO VARCHAR(32) NOT NULL,
DIAGNOSTICO2 VARCHAR(32),
DIAGNOSTICO3 VARCHAR(32),
NOTA VARCHAR(250) NOT NULL

);

mysql_query("insert into NMEDICA(
		FECHACONSULTA,
		CLAVEMEDICO,
		AFILIACIONP,
		ALTURA,
		PESO,
		MCORPORAL,
		TEMPERATURA,
		FRECUENCIAR,
		PRESIONA,
		FRECUENCIAC,
		DIAGNOSTICO,
		DIAGNOSTICO2,
		DIAGNOSTICO3,
		NOTA) 
		values ('$fecha',
				'$cm',
				'$afiliacion',
				'$texto',
				'$diagnostico',
				'$diagnosticoa',
				'$diagnosticob',
				'$tipoc',
				'$folioi',
				'$finicio',
				'$diasi')");


	mysqli_close($link);
}

CREATE TABLE HISTORIA(
id_historia int not null auto_increment primary key,
FECHA DATE NOT NULL,
CLAVEMEDICO VARCHAR(12) NOT NULL,
AFILIACIONP VARCHAR(64) NOT NULL,
HISTORIA SET('hdiabetes','hhipertension','htuberculosis','hcancer','htiroides','ppdiabetes','pphipertension','pptuberculosis',
'ppcancer','pptiroides','ppvaricela','pphepatitis','pnptabaquismo','pnpalcoholismo','pnptoxicomanias','pnpautomedicacion')

);
